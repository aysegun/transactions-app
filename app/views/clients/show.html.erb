<h3>Show page</h3>
<p>Find me on "...clients/views/clients/show.html.erb"</p>

<h3>Calculation for <%= @client.last_name %>, <%= @client.first_name %></h3>
<div class="d-flex" style= "gap: 150px">
  <h4>Balance <i class="fa-solid fa-coins"></i></h4>
  <p><%= Date.today %> <i class="fa-regular fa-calendar-days"></i></p>
</div>
<div class="d-flex" style= "gap: 150px">
  <h3><%= (@payments.sum(:amount) - @expenses.sum(:amount)) %> <i class="fa-solid fa-turkish-lira-sign"></i></h3>
  <%= link_to "Create Transaction", new_client_transaction_path(@client), class:"btn btn-success" %>
</div>
<div class="calculation-container mt-5">
  <table>
    <thead>
      <tr>
        <th>Total Expenses <i class="fa-regular fa-paper-plane"></i></th>
        <th>Total Payments <i class="fa-solid fa-arrow-down"></i></th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><%= @expenses.sum(:amount) %> <i class="fa-solid fa-turkish-lira-sign"></td>
        <td><%= @payments.sum(:amount) %> <i class="fa-solid fa-turkish-lira-sign"></td>
      </tr>
    </tbody>
  </table>
</div>



<div class="mt-5">
  <h3>Expense History for <%= @client.last_name %>, <%= @client.first_name %></h3>
  <div class="expense-table">
    <table>
      <thead>
        <tr>
          <th>Amount <i class="fa-solid fa-turkish-lira-sign"></th>
          <th>Description</th>
          <th>Date</th>
          <th>Type</th>
          <th>Court</th>
          <th>Court Number</th>
          <th>Action</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% @transactions.each do |transaction| %>
          <% if transaction.transaction_type == 'expense' %>
            <tr>
              <td><%= transaction.amount %></td>
              <td><%= transaction.description %></td>
              <td><%= transaction.date %></td>
              <td style="color:red"><%= transaction.transaction_type %></td>

              <% transaction.transaction_cases.each do |transaction_case| %>
                <% case_record = transaction_case.case %>
                <td><%= case_record&.court %></td>
                <td><%= case_record&.court_number %></td>
              <% end %>

              <td><%= button_to "", client_transaction_path(@client, transaction), class: "fa-regular fa-trash-can",
                                method: :delete, data: { turbo_confirm: "Are you sure you want to delete this transaction?" } %></td>
              <td><%= link_to "Edit", edit_client_transaction_path(@client, transaction) %></td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
  </div>

  <div class="mt-5">
    <h3>Payment History for <%= @client.last_name %>, <%= @client.first_name %></h3>
    <div class="payment-table">
      <table>
        <thead>
          <tr>
            <th>Amount <i class="fa-solid fa-turkish-lira-sign"></th>
            <th>Description</th>
            <th>Date</th>
            <th>Type</th>
            <th>Action</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% @transactions.each do |transaction| %>
            <% if transaction.transaction_type == 'payment' %>
              <tr>
                <td><%= transaction.amount %></td>
                <td><%= transaction.description %></td>
                <td><%= transaction.date %></td>
                <td style="color:green"><%= transaction.transaction_type %></td>
                <td><%= button_to "", client_transaction_path(@client, transaction), class: "fa-regular fa-trash-can",
                                  method: :delete, data: { turbo_confirm: "Are you sure you want to delete this transaction?" } %></td>
                <td><%= link_to "Edit", edit_client_transaction_path(@client, transaction) %></td>
              </tr>
            <% end %>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<%= link_to "Return Clients", clients_path, class:"btn btn-primary mt-5" %>

<p></p>
<%= button_to "Delete Client", @client, method: :delete, data: {turbo_confirm: "Are you sure you want to delete this client?"}, class:"btn btn-danger" %>
<p></p>
<%= link_to "Edit Client", edit_client_path,  class: "btn btn-warning" %>
